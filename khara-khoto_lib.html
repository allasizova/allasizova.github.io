<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tibetan Buddhist Texts from Khara-Khoto: A Database</title>
    <style>
		body {
            font-family: book antiqua;}
        .container { margin-bottom: 20px; }
		.text-item {
			background-color: #e6ffe6; /* Светло-зеленый для текстов */
			border: 1px solid #ccc; /* Граница вокруг каждого элемента */
			border-radius: 5px; /* Скругление углов для более мягкого внешнего вида */
		}

		.manuscript-item {
			background-color: #e6f2ff; /* Светло-синий для рукописей */
			border: 1px solid #ccc; /* Граница вокруг каждого элемента */
			border-radius: 5px; /* Скругление углов для более мягкого внешнего вида */
		}

		.publication-item {
			background-color: #fff0f0; /* Светло-красный для публикаций */
			border: 1px solid #ccc; /* Граница вокруг каждого элемента */
			border-radius: 5px; /* Скругление углов для более мягкого внешнего вида */
		}
		.text-item, .manuscript-item, .publication-item {
			line-height: 1; /* Устанавливает межстрочный интервал в нормальное состояние, без дополнительного пространства */
		}
		
		.label-alternative-titles {
			color: #0a4a0a;
			font-weight: bold;
		}

		.label-notes {
			color: #0a4a0a;
			font-weight: bold;
		}
		
		.label-manuscripts {
			color: #0a4a0a;
			font-weight: bold;
		}
		
		.label-publications {
			color: #0a4a0a;
			font-weight: bold;
		}
		
		.label-collection {
			color: #083669;
			font-weight: bold;
		}
		
		.label-shelfmark {
			color: #083669;
			font-weight: bold;
		}
		
		.manuscript-notes {
			color: #083669;
			font-weight: bold;
		}

		.manuscript-texts {
			color: #083669;
			font-weight: bold;
		}
		
		.manuscript-publications {
			color: #083669;
			font-weight: bold;
		}
		
		.label-authors {
			color: #800505;
			font-weight: bold;
		}
		
		.label-place {
			color: #800505;
			font-weight: bold;
		}
		
		.label-tags {
			color: #800505;
			font-weight: bold;
		}
		
		.label-pub-notes {
			color: #800505;
			font-weight: bold;
		}
    </style>
</head>
<body>
    <h1 style="color: #000000; text-align: center;">
        Tibetan Buddhist Texts from Khara-Khoto:<br>A Database
    </h1>
	<div style="text-align: center;">
    <img src="garuda_sm.png" width="200">
	</div>
	<div id="textsContainer" class="container">
    <h2 style="text-align: center;">TEXTS</h2>
	</div>
    <div id="manuscriptsContainer" class="container">
    <h2 style="text-align: center;">SOURCES<br>(manuscripts and blockprints)</h2>
	</div>
	<div id="publicationsContainer" class="container">
    <h2 style="text-align: center;">PUBLICATIONS</h2>
	</div>

    <script>
        const texts = [
            {
                textId: 1,
                textTitle: "Uṣṇīṣavijaya-dhāraṇīsūtra",
                textAlternativeTitle: "uṣṇīṣavijayā nāma dhāraṇī anuśaṃsasahitasūtrāt saṃgṛhītā, gtsug tor rnam par rgyal ma’i gzungs phan yon dang bcas pa’ | mdo’ las btus pa",
                manuscriptIds: [2, 4],
                publicationIds: [1],
                textNotes: "123",
            }
            // Добавьте дополнительные тексты здесь
        ];
        const manuscripts = [
            {
                manuscriptId: 1,
                manuscriptTitle: "A collection of Buddhist texts",
                collection: ["St. Petersburg"],
                shelfmark: "Kh. Tib. 16",
                textIds: [],
                publicationIds: [],
                manuscriptNotes: "Fragment of a manuscript; pothi; <i>dbu chen</i>; 89 folios. Two volumes, the folios of the second volume are marked with the letter <i>ka</i>.<br><b>Volume 1</b>: folios 2, 4, 6, 8–10, 18, 22, 33, 34, 37, 39–41, 46–49, 52, 53, 56, 60–[62], 64–67, 67доп, 68–71, 73, 74, 76–89, 99, 100.<br><b>Volume 2</b>: folios 1–14, 16, 17, 19–22, 25, 26, 27/28, 29–[32], 34, [35], 38, 39, 43, [45], 46, 48, 49, 52.<br><b>Volume 1</b>: 1. f. <...>2a1—2b5<...>: ’phags pa sangs rgyas rjes su dran pa (without beginning and end); 2. <...>4a1—4b3: chos rjes su dran pa (without beginning); 3. 4b3—4b5<...>: dge ’dun rjes su dran pa (without end); 4. <...>6a1—10b5<...>: byang chub ltung bshags (without beginning and end); 5. <...>18a1—41b5<...>: ’jam dpal ye shes sems dpa’i don dam pa’i mtshan yang dag par brjod pa (without beginning and end); 6. <...>46a1—49b5<...>: ’phags pa ’jam dpal gyi mtshan brgya rtsa brgyad pa zhes bya ba (without beginning and end); 7. <...>52a1—52а3: rje btsun ’phags pa ’jam dpal gyi shes rab dang blo ’phel ba zhes bya ba’i gzungs (without beginning); 8. 52a3—52b5: ’phags pa las kyi sgrib pa thams cad rnam par sbyong ba zhes bya ba’i gzungs; 9. 53a1—53b2: ngan song thams cad yongs su sbyong ba’i gzungs; 10. 53b2—53b5: yon yongs su dag pa’i gzungs; 11. <...>56a1—100b5: ’phags pa shes rab kyi pha rol tu phyin pa sdud pa tshigs su bcad pa (first part, without beginning).<br><b>Volume 2</b>: 1a1—22b5: ’phags pa shes rab kyi pha rol tu phyin pa sdud pa tshigs su bcad pa (second part); 12. <...>25a1—[35]b5<...>: ’phags pa bzang po spyod pa’i smon lam gyi rgyal po (without beginning and end); 13. 38a1—39b5<...>: stong chen mo rab tu ’joms pa las gsungs pa’i smon lam (without end); 14. <...>43a1—[45]b2: mdzad pa bcu gnyis kyi bkra shis tshigs su bcad pa (without beginning); 15. 46a1—49b5: ’phags pa byams pa’i smon lam; 16. 52a1—4: the hundred syllable Vajrasattva mantra.",
            },
			{
                manuscriptId: 2,
                manuscriptTitle: "A collection of two dhāraṇīs with the Emperor Renzong’s afterword, dated from 1149 or a few years later",
                collection: ["St. Petersburg"],
                shelfmark: "Kh. Tib. 63, 64, 67, 68",
                textIds: [1],
                publicationIds: [1],
                manuscriptNotes: "Fragments of a block print; black ink; folios were printed in spreads with foliation in Chinese and with <i>baikou</i>, the original number of folios is unknown; the following folios have survived (sometimes only the left or right halves):<br>Text 1 (’phags pa spyan ras gzigs dbang phyug thugs rje chen po’I gzungs phan yon dang bcas pa’ mdo ltar btus pa): 2l, 3–5, 6l, 9r, 10–12, 13l, 23r, 24–26, 27l<br>Text 2 (gtsug tor rnam par rgyal ma’I gzungs phan yon dang bcas pa’ mdo ltar btus pa): 34r, 35l, 37r, 38l, 40r, 41–44, 45r, 49r, 50, 51, 52, 53, 54l<br>Text 3 (the Emperor Renzong’s afterword): 56r, 57, 58, 59l, 60r, 61l",
            },
			{
                manuscriptId: 3,
                manuscriptTitle: "Mañjuśrījñānasattvasyaparamārthanāmasaṃgīti, Vāgīśvarastotra",
                collection: ["St. Petersburg"],
                shelfmark: "Kh. Tib. 127",
                textIds: [],
                publicationIds: [2],
                manuscriptNotes: "Fragment, block print; vertical concertina-style book. 10 folios without foliation. Double bars on the sides (12.7 cm). Chinese foliation ‘22’ (廿二) on internal fold.<br>1. ’Jam dpal ye shes sems dpa’i don dam pa’i mtshan yang dag par brjod pa (Mañjuśrījñānasattvasyaparamārthanāmasaṃgīti);<br>2. Ngag gi dbang phyug la bstod pa (Vāgīśvarastotra).",
            },
			{
                manuscriptId: 4,
                manuscriptTitle: "A collection of Buddhist texts",
                collection: ["St. Petersburg"],
                shelfmark: "Kh. Tib. 126, 159, 62",
                textIds: [1],
                publicationIds: [],
                manuscriptNotes: "Fragment of a manuscript; pothi; dbu chen; 31 folio.<br>KA: folios 1—7, 9—12, 31, 32, 34—37 (additional draft of the folio 36), 39—50.<br>PHA: 1 folio (without foliation).<br> KA: 1. л. 1a1—12a5: dpal lha mo gtsug tor rol pa’i ta+ntra; 2. 12b1—5: [gtsug tor]; 3. <...>31a1—42b5: ’phags pa spyan ras gzigs dbang phyug thugs rje chen po’i gzungs phan yon dang bcas pa zhes bya ba’i mdo las btus pa (without beginning); 4. [42]a1—50b5: [gtsug tor rnam par rgyal ma’I gzungs phan yon dang bcas pa’ mdo ltar btus pa] (without beginning);<br>PHA: [1]a1—b5: ’phags ma ’od zer can zhes bya ba’i gzungs (without end).",
            }
            // Добавьте дополнительные рукописи здесь
        ];
		const publications = [
			{
				publicationId: 1,
				authors: ["Hamanaka S.", "Sizova A."],
				publicationTitle: "Imperial Postscript to the Tangut, Chinese and Tibetan Editions of the Dhāraṇī-sūtras in the Collection of the IOM, RAS.",
				publicationPlace: "WMO. Vol. 6, No. 2(12), 2020. P. 65–92.",
				textIds: [1],
				manuscriptIds: [1],
				tags: ["item description"],
				url: "https://journals.eco-vector.com/2410-0145/article/view/48894",
				publicationNotes: "Three parallel editions of dhāraṇī-sūtras in Tangut, Chinese and Tibetan languages were published in the Tangut state in 1149. The Tibetan edition is of particular importance, because until recently specimens of printing in Tibetan, that could belong to an earlier date, have not been found anywhere. All the editions are equal in terms of their contents and contain the postscript written by the Emperor Renzong. The main goal of the article is to introduce the previously unpublished Tibetan text of the postscript in correspondence with the Tangut and Chinese versions. Besides, the article provides information about the study, preservation state, and codicology of all the three editions.",
			},
			{
				publicationId: 2,
				authors: ["Turanskaya A."],
				publicationTitle: "A Tibetan Block Print in the Collection of Tibetan Texts from Khara-khoto of the IOM, RAS.",
				publicationPlace: "Pis’mennye pamiatniki Vostoka. 2021, volume 18, no. 2 (issue 45). P. 5–23.",
				textIds: [1],
				manuscriptIds: [1],
				tags: ["item description"],
				url: "http://www.orientalstudies.ru/rus/images/pdf/journals/PPV_18_2_45_2021_01_turanskaya.pdf",
				publicationNotes: "(In Russian) Fragments of Tibetan manuscripts and block prints from Khara-Khoto, which were transferred to the Asiatic Museum after P.K. Kozlov’s Mongolian-Sichuan Expedition, have been insufficiently studied. As a result of the cataloguing project initiated by researchers of the IOM, RAS, in 2018, an unknown Tibetan block print drew our attention. The preserved fragment includes two texts dedicated to the Buddhist deity Mañjuśrī. This paper presents a brief archaeographic description of the block print, a transliteration and translation of the surviving parts of the texts.",
			}
			// Add additional publications here
		];

		function getPublicationReference(publicationIds) {
			const publicationReferences = publicationIds.map(publicationId => {
				// Find the publication by ID
				const publication = publications.find(pub => pub.publicationId === publicationId);
				// If publication is found
				if (publication) {
					// Extract surnames
					const surnames = publication.authors.map(author => {
						const parts = author.split(' '); // Split the author name into parts
						return parts[0]; // Assuming the first part is the surname
					}).join(', '); // Join the surnames with a comma

					const yearMatch = publication.publicationPlace.match(/\d{4}/); // Extract year
					const year = yearMatch ? yearMatch[0] : 'Unknown Year';

					return `<a href="#publication-${publicationId}">${surnames} ${year}</a>`;
				} else {
					return `Unknown Publication ${publicationId}`;
				}
			});
			return publicationReferences.join('; ');
		}

		function getManuscriptReference(manuscriptIds) {
			// Adjusted to return shelfmark of each manuscript as the link text
			const manuscriptReferences = manuscriptIds.map(manuscriptId => {
				// Find the manuscript by ID
				const manuscript = manuscripts.find(ms => ms.manuscriptId === manuscriptId);
				// Use the shelfmark as the link text, if the manuscript is found
				if (manuscript) {
					return `<a href="#manuscript-${manuscriptId}">${manuscript.shelfmark}</a>`;
				} else {
					return `Unknown Manuscript ${manuscriptId}`;
				}
			});
			return manuscriptReferences.join('; ');
		}
		
		function getTextReferences(textIds) {
			// Iterate over each textId in the textIds array, find the corresponding text, and return its title.
			const textReferences = textIds.map(textId => {
				const text = texts.find(txt => txt.textId === textId); // Corrected to match against textId of each text
				return text ? `${text.textTitle}` : `Unknown Text ${textId}`; // Check if text is found
			});
			
			// Join all found text titles with a comma or any other delimiter as appropriate
			return textReferences.join(', ');
		}
		
		// Corrected displayData function to append to publicationsContainer correctly
		function displayData() {
		
			const textsContainer = document.getElementById('textsContainer');
			texts.forEach(text => {
				const textEl = document.createElement('div');
				textEl.classList.add('text-item');
				textEl.innerHTML = `<h3>${text.textTitle}</h3>
									<p><span class="label-alternative-titles">Alternative Titles:</span> ${text.textAlternativeTitle}</p>
									<p><span class="label-notes">Notes:</span> ${text.textNotes}</p>
									<p><span class="label-manuscripts">Sources:</span> ${getManuscriptReference(text.manuscriptIds)}</p>
									<p><span class="label-publications">Publications:</span> ${getPublicationReference(text.publicationIds)}</p>`;
				textsContainer.appendChild(textEl);
			});

            // Функции отображения для рукописей
            const manuscriptsContainer = document.getElementById('manuscriptsContainer');
			manuscripts.forEach(manuscript => {
				const manuscriptEl = document.createElement('div');
				manuscriptEl.classList.add('item', 'manuscript-item');
				manuscriptEl.setAttribute('id', `manuscript-${manuscript.manuscriptId}`);
				let textsHtml = manuscript.textIds.map(textId => `<a href="#text-${textId}">${getTextReferences([textId])}</a>`).join(', ');
				let publicationsHtml = manuscript.publicationIds.map(publicationId => `<a href="#publication-${publicationId}">${getPublicationReference([publicationId])}</a>`).join(', ');
				manuscriptEl.innerHTML = `<h3>${manuscript.manuscriptTitle}</h3>
										  <p><span class="label-collection">Collection:</span> ${manuscript.collection.join(', ')}</p>
										  <p><span class="label-shelfmark">Shelfmark:</span> ${manuscript.shelfmark}</p>
										  <p><span class="manuscript-notes">Notes:</span> ${manuscript.manuscriptNotes}</p>
										  <p><span class="manuscript-texts">Texts:</span> ${textsHtml}</p>
										  <p><span class="manuscript-publications">Publications:</span> ${publicationsHtml}</p>`;
				manuscriptsContainer.appendChild(manuscriptEl);
			});

            // Функции отображения для публикаций
			const publicationsContainer = document.getElementById('publicationsContainer');
			publications.forEach(publication => {
				const publicationEl = document.createElement('div');
				publicationEl.classList.add('item', 'publication-item');
				publicationEl.setAttribute('id', `publication-${publication.publicationId}`); // Corrected to publication.publicationId
				publicationEl.innerHTML = `<h3>${publication.publicationTitle}</h3>
										   <p><span class="label-authors">Authors:</span> ${publication.authors.join(', ')}</p>
										   <p><span class="label-place">Place:</span> ${publication.publicationPlace}</p>
										   <p><span class="label-tags">Tags:</span> ${publication.tags.join(', ')}</p>
										   <a href="${publication.url}" target="_blank">Download</a>
										   <p><span class="label-pub-notes">Notes:</span> ${publication.publicationNotes}</p>`;
				publicationsContainer.appendChild(publicationEl);
			});
        }

        window.onload = displayData;
    </script>
</body>
</html>